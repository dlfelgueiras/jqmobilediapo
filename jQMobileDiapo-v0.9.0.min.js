(function(a){a.fn.jQMobileDiapo=function(b){var c={prevId:"prevBtn",prevText:"<<",nextId:"nextBtn",nextText:">>",backId:"backBtn",backText:"Back",backLink:"#",controlsShow:true,speed:250,btnTime:2000,imgReplace:"images/no-image.jpg",images:[]};b=a.extend(c,b);this.each(function(){var k=a(this),u=a(this).get(0),s=b.images,w=s.length,d=navigator.userAgent.toLowerCase(),D=(d.indexOf("iphone")!=-1),C=0,e=1,f=a(window).height(),x=a(window).width(),l;k.empty();k.css({overflow:"hidden",position:"absolute"});var B=document.createElement("a");B.setAttribute("href",b.backLink);B.appendChild(document.createTextNode(b.backText));var j=document.createElement("div");j.setAttribute("class","btn");j.appendChild(B);u.appendChild(j);if((typeof s=="object")&&w){var q=document.createElement("ul");q.setAttribute("id","imgContainer");var g=document.createElement("li"),p=document.createElement("img");p.setAttribute("onerror","this.src='"+b.imgReplace+"';");g.appendChild(p);for(var v=0;v<w;v++){s[v]={added:false,url:s[v]};q.appendChild(g.cloneNode(true))}var m=document.createElement("div");m.setAttribute("id","btnNav");m.setAttribute("class","btn");var z=document.createElement("div");z.setAttribute("id",b.prevId);z.setAttribute("style","float:left;display:none;");var o=document.createElement("a");o.setAttribute("href","javascript:void(0);");o.appendChild(document.createTextNode(b.prevText));var A=document.createElement("div");A.setAttribute("id",b.nextId);A.setAttribute("style","float:right;width:100%;");var r=document.createElement("a");r.setAttribute("href","javascript:void(0);");r.appendChild(document.createTextNode(b.nextText));u.appendChild(q);z.appendChild(o);m.appendChild(z);A.appendChild(r);m.appendChild(A);u.appendChild(m)}setTimeout(function(){if(D){f=window.innerHeight;x=window.innerWidth}k.css({height:f+"px",width:x+"px"});k.find("li").each(function(){C++;a(this).css({height:f+"px",width:x+"px"})});k.find("ul").css({height:f+"px",width:(x*C)+"px"});k.find("img").css({"max-height":f+"px","max-width":x+"px"});a("#btnNav").css({top:(f-a("#btnNav").outerHeight())+"px"});a(k.find("img")[e-1]).load(function(){var i=Math.ceil((f-a(this).height())/2);a(this).css({"margin-top":i+"px"})})},100);if(b.controlsShow){setTimeout(function(){a(".btn").hide()},b.btnTime)}else{a(".btn").hide()}function n(G){if(!s[G].added){var t=s[G].url,i=k.find("ul li").get(G);a(i).find("img").attr("src",t);s[G].added=true}}function F(){if(b.controlsShow){clearTimeout(l);a(".btn").show();l=setTimeout(function(){a(".btn").hide()},b.btnTime)}}function E(){F();if(e<C){e++;k.find("ul").animate({left:"-="+x},b.speed);a(k.find("img")[e-1]).each(function(){var i=Math.ceil((f-a(this).height())/2);a(this).css({"margin-top":i+"px"})});if(e<s.length){n(e)}if(e>1){a("#"+b.nextId).css({width:"50%"}).show();a("#"+b.prevId).css({width:"50%"}).show()}}if(e==C){a("#"+b.nextId).hide();a("#"+b.prevId).css({width:"100%"}).show()}}function h(){F();if(e>1){e--;k.find("ul").animate({left:"+="+x},b.speed);a(k.find("img")[e-1]).each(function(){var i=Math.ceil((f-a(this).height())/2);a(this).css({"margin-top":i+"px"})});if(e<C){a("#"+b.nextId).css({width:"50%"}).show();a("#"+b.prevId).css({width:"50%"}).show()}}if(e==1){a("#"+b.prevId).hide();a("#"+b.nextId).css({width:"100%"}).show()}}function y(){window.scrollTo(0,1);f=a(window).height();x=a(window).width();if(D){f=window.innerHeight;x=window.innerWidth}var t=k.find("ul"),i=k.find("img");k.css({height:f+"px",width:x+"px"});k.find("li").css({height:f+"px",width:x+"px"});t.css({height:f+"px",width:(x*C)+"px"});i.css({"max-height":f+"px","max-width":x+"px"});t.css({left:"-"+((e-1)*x)+"px"});a("#btnNav").css({top:(f-a("#btnNav").outerHeight())+"px"});a(i[e-1]).each(function(){var G=Math.ceil((f-a(this).height())/2);a(this).css({"margin-top":G+"px"})})}a(window).bind("orientationchange",function(i){setTimeout(function(){y()},100)});a(window).resize(function(){setTimeout(function(){y()},100)});a("#"+b.prevId).click(function(){h()});a("#"+b.nextId).click(function(){E()});k.bind("swipeleft",function(i){i.stopImmediatePropagation();E()});k.bind("swiperight",function(i){i.stopImmediatePropagation();h()});a(window).bind("vclick",function(i){F()});n(0);n(1);setTimeout(function(){y()},100)})}})(jQuery);